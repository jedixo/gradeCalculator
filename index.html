<html>

<head>

    <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo"
        crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js" integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49"
        crossorigin="anonymous"></script>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css" integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO"
        crossorigin="anonymous">
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js" integrity="sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy"
        crossorigin="anonymous"></script>

    <SCRIPT language="javascript">
        var index = 0;
        var gradeData = [];
        var outputs = [];
        var data = [];

        //initialises data needed for calculations
        function init() {
            //grabs output elements
            gradeData.push(document.getElementById("neededC"));
            gradeData.push(document.getElementById("neededD"));
            gradeData.push(document.getElementById("neededHD"));
            gradeData.push(document.getElementById("totEarned"));
            gradeData.push(document.getElementById("avgMark"));
            //sets initital values for outputs
            for (var i = 0; i < gradeData.length; i++) {
                gradeData[i].innerHTML = "0";
                outputs.push(0);
            }
            //final exam worth if needed
            outputs.push(0);
        };

        //adds a new subject table
        function addNew() {
            var io = []

            var tr = document.createElement("tr");
            tr.setAttribute("id", "sub" + index);

            var tdname = document.createElement("td");
            tdname.setAttribute("id", "name" + index);
            var inpdiv = document.createElement("div");
            inpdiv.setAttribute("class", "input-group");
            var inpname = document.createElement("input");
            inpname.setAttribute("type", "text");
            inpname.setAttribute("id", "nameInput" + index);
            inpname.setAttribute("class", "form-control");
            inpname.setAttribute("placeholder", "Assessment Name");
            inpname.setAttribute("aria-describedby", "basic-adon1");
            inpdiv.appendChild(inpname)
            tdname.appendChild(inpdiv);
            tr.appendChild(tdname);

            var tdworth = document.createElement("td");
            tdworth.setAttribute("id", "worth" + index);
            var inpdivworth = document.createElement("div");
            inpdivworth.setAttribute("class", "input-group");
            var inpdivworthprep = document.createElement("div");
            inpdivworthprep.setAttribute("class", "input-group-prepend");
            var inpdivworthprepspan = document.createElement("span");
            inpdivworthprepspan.setAttribute("class", "input-group-text");
            inpdivworthprepspan.innerHTML = "%";
            inpdivworthprep.appendChild(inpdivworthprepspan);
            inpdivworth.appendChild(inpdivworthprep);
            var ipworth = document.createElement("input");
            ipworth.setAttribute("type", "number");
            ipworth.setAttribute("class", "form-control");
            ipworth.setAttribute("aria-describedby", "basic-adon1");
            ipworth.setAttribute("id", "worthInput" + index);
            ipworth.setAttribute("placeholder", "100");
            io.push(ipworth);
            inpdivworth.appendChild(ipworth)
            tdworth.appendChild(inpdivworth);
            tr.appendChild(tdworth);

            var tdrec = document.createElement("td");
            tdrec.setAttribute("id", "rec" + index);
            var inpdivrec = document.createElement("div");
            inpdivrec.setAttribute("class", "input-group");
            var inpdivrecprep = document.createElement("div");
            inpdivrecprep.setAttribute("class", "input-group-prepend");
            var inpdivrecprepspan = document.createElement("span");
            inpdivrecprepspan.setAttribute("class", "input-group-text");
            inpdivrecprepspan.innerHTML = "%";
            inpdivrecprep.appendChild(inpdivrecprepspan);
            inpdivrec.appendChild(inpdivrecprep);
            var iprec = document.createElement("input");
            iprec.setAttribute("type", "number");
            iprec.setAttribute("class", "form-control");
            iprec.setAttribute("aria-describedby", "basic-adon1");
            iprec.setAttribute("id", "recInput" + index);
            iprec.setAttribute("placeholder", "100");
            io.push(iprec);
            inpdivrec.appendChild(iprec)
            tdrec.appendChild(inpdivrec);
            tr.appendChild(tdrec);

            var tdear = document.createElement("td");
            tdear.setAttribute("id", "ear" + index);
            var inpdivear = document.createElement("div");
            inpdivear.setAttribute("class", "input-group");
            var inpdivearprep = document.createElement("div");
            inpdivearprep.setAttribute("class", "input-group-prepend");
            var inpdivearprepspan = document.createElement("span");
            inpdivearprepspan.setAttribute("class", "input-group-text");
            inpdivearprepspan.innerHTML = "%";
            inpdivearprep.appendChild(inpdivearprepspan);
            inpdivear.appendChild(inpdivearprep);
            var ipear = document.createElement("input");
            ipear.setAttribute("type", "number");
            ipear.setAttribute("class", "form-control");
            ipear.setAttribute("aria-describedby", "basic-adon1");
            ipear.setAttribute("id", "recInput" + index);
            ipear.setAttribute("value", "0");
            ipear.setAttribute("disabled", "true");
            io.push(ipear);
            inpdivear.appendChild(ipear)
            tdear.appendChild(inpdivear);
            tr.appendChild(tdear);

            var tddel = document.createElement("td");
            tddel.setAttribute("id", "del" + index);
            tddel.setAttribute("class", "text-right");
            var tddelbut = document.createElement("button");
            tddelbut.setAttribute("type", "button");
            tddelbut.setAttribute("class", "btn btn-danger");
            tddelbut.setAttribute("disabled", "true");
            tddelbut.setAttribute("onclick", "removeRow(" + data.length + ");");
            tddelbut.innerHTML = "&#x268A";
            io.push(tddelbut);
            tddel.appendChild(tddelbut);
            tr.appendChild(tddel);

            var foo = document.getElementById("subjectTable");
            foo.appendChild(tr);
            io.push(0);
            io.push(index);
            data.push(io);
            //data.push(index);

            if (data.length > 1) {
                for (var i = 0; i < data.length; i++) {
                    data[i][data[i].length - 3].disabled = false;
                }
            }
            index++;
        }

        function removeRow(row) {
            document.getElementById("sub" + data[row][data[row].length - 1]).outerHTML = "";
            data.splice(row, 1);

            for (var i = 0; i < data.length; i++) {
                data[i][data[i].length - 3].setAttribute("onclick", "removeRow(" + i + ");");
                if (data.length === 1) {
                    data[i][data[i].length - 3].disabled = true;
                }
            }
        }



    </SCRIPT>
</head>

<body>

    <h1 class="text-center" style="width: 100%;">Jake's Grade Calculator -
        <small class="text-muted">Version 2.0</small>
    </h1>
    <div class="table-responsive mx-auto" style="width: 95%;">
        <table class="table table-striped table-dark" id="resultsTable" name="resultsTable">

            <thead>
                <tr>
                    <th class="text-center" scope="col" data-toggle="tooltip" title="<table ><tr><td class='text-center' style='color:White;'>Average mark per assesment</td></tr></table>">Average Mark</th>
                    <th class="text-center" scope="col" data-toggle="tooltip" title="<table ><tr><td class='text-center' style='color:White;'>Overal current grade</td></tr></table>">Total Currently Earned</th>
                    <th class="text-center" scope="col" data-toggle="tooltip" title="<table ><tr><td class='text-center' style='color:White;'>Grade needed for A High Distinction</td></tr></table>"
                        style='color:lightblue;'>Needed for HD</th>
                    <th class="text-center" scope="col" data-toggle="tooltip" title="<table ><tr><td class='text-center' style='color:White;'>Grade needed for A Distinction</td></tr></table>"
                        style='color:lightgreen;'>Needed for D</th>
                    <th class="text-center" scope="col" data-toggle="tooltip" title="<table ><tr><td class='text-center' style='color:White;'>Grade needed for A Credit</td></tr></table>"
                        style='color:lightgoldenrodyellow;'>Needed for C</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td class="text-center" id="avgMark">0</td>
                    <td class="text-center" id="totEarned">0</td>
                    <td class="text-center" id="neededHD">0</td>
                    <td class="text-center" id="neededD">0</td>
                    <td class="text-center" id="neededC">0</td>
                </tr>
            </tbody>
        </table>
    </div>
    <div class="progress mx-auto" style="width: 95%; ">
        <div class="progress-bar-striped" role="progressbar" style="width: 100%" aria-valuenow="100" aria-valuemin="0" aria-valuemax="100"></div>
    </div>
    <div style="padding-bottom: .8%"></div>
    <div class="table-responsive mx-auto" style="width: 95%;">
        <table class="table table-striped" id="subjectTable" name="subjectTable">

            <thead class="thead-dark">
                <tr>
                    <th class="text-center align-middle" scope="col" data-toggle="tooltip" title="<table ><tr><td class='text-center' style='color:White;'>Optional</td></tr></table>">Subject Name</th>
                    <th class="text-center align-middle" scope="col" data-toggle="tooltip" title="<table ><tr><td class='text-center' style='color:White;'>Percentage of the subjects overall weight</td></tr></table>">Overall Weight</th>
                    <th class="text-center align-middle" scope="col" data-toggle="tooltip" title="<table ><tr><td class='text-center' style='color:White;'>Grade for individual assesment piece</td></tr></table>">Mark Received</th>
                    <th class="text-center align-middle" scope="col" data-toggle="tooltip" title="<table ><tr><td class='text-center' style='color:White;'>Percentage of overall subject grade</td></tr></table>">Overall Grade</th>
                    <th class="text-right" scope="col">
                        <button type="button" class="btn btn-primary " data-toggle="tooltip" data-placement="bottom" title="add another row" onclick="addNew()">&#x271A</button>
                    </th>
                </tr>
            </thead>
            <tbody>
            </tbody>
        </table>
    </div>
    <button type="button" class="btn btn-primary btn-lg btn-block mx-auto" style="width: 95%">Calculate</button>
    <script>
        init(); addNew();
        $('th[data-toggle="tooltip"]').tooltip({ html: true });
        $('button[data-toggle="tooltip"]').tooltip({ html: true });</script>

</body>

</html>